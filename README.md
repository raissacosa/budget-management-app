# Budget Management Application

---

## Overview

Budget Management App is a Spring Boot application that helps users manage their personal finances.
This REST API allows full CRUD operations on categories and transactions, and also offers various reports based on category tracking.
It is built with clean architecture principles and role-based access control to secure the endpoints.

---

## Technologies Used

- **Java 17**
- **Spring Boot 3**
    - Spring Security (JWT)
    - Spring Data JPA
    - Spring Profiles (`dev`, `test`)
- **PostgreSQL** (for development)
- **H2 Database** (for testing)
- **Docker & Docker Compose**
- **Maven** (build tool)
- **JUnit 5 & Mockito** (testing)
- **SLF4J / Logback** (logging)

---

## Setup

### Clone the Project

```
git clone https://github.com/raissacosa/budget-management-app.git
cd budget-management
```

### Dev Profile Setup (PostgreSQL with Docker)

Make sure Docker is running, then start the database container:

```
docker-compose up -d
```

The application is configured to use PostgreSQL for the dev profile.

Build the project:
```
./mvnw clean install
```

Run the app:

```
./mvnw spring-boot:run 
```
The dev profile is set as default in application.properties, so no additional flags are required.

### Test Profile (H2 in-memory)

No setup required.
The test profile is used automatically during test execution and uses an in-memory H2 database.

---

## Security

The application supports two roles:

- **ADMIN**: Can manage categories. This user is automatically inserted into the database at first application startup (if it doesn't already exist).
- **USER**: Can register and manage their own transactions.

### Authentication & Registration

Users can register via:

```
POST: /api/v1/auth/register
```

This will create a new user with the `USER` role by default.

JWT-based authentication is used.  
Tokens are generated by:

```
POST: /api/v1/auth/login
```

### Demo Credentials for ADMIN role:

```
Email:    admin@mail.com
Password: admin123
```

---
## Features

### User Management
- Register new users with role `USER`
- Authenticate using JWT-based login
- Role-based access: `ADMIN` and `USER`

### Category Management (ADMIN only)
- Add new categories
- Update existing categories
- View all categories
- View only active categories (also accessible by `USER`)

### Transaction Management (USER only)
- Add new income or expense transactions
- View and filter transactions by:
    - amount
    - type (INCOME/EXPENSE)
    - date range
    - category
- Delete existing transactions

### Reporting & Insights (USER only)
- View total amount spent per category
- See top 3 categories with highest spending
- Get monthly summary of income and expenses
- Check account balance (income â€“ expenses)

### Export (USER only)
- Export all user transactions to CSV

---

## Endpoints

```
POST   /api/v1/auth/register                            # Register a new user with role 'USER'
POST   /api/v1/auth/login                               # Generate JWT token

POST   /api/v1/categories                               # Add a new category (ADMIN only)
PUT    /api/v1/categories/{id}                          # Edit category (ADMIN only)
GET    /api/v1/categories                               # View all categories (ADMIN only)
GET    /api/v1/categories/active                        # View only active categories (USER/ADMIN)

POST   /api/v1/transactions                             # Add a new transaction (USER only)
GET    /api/v1/transactions                             # Filter and list transactions (USER only)
DELETE /api/v1/transactions/{id}                        # Delete a transaction (USER only)
GET    /api/v1/transactions/expenses/by-category        # Total spent per category (USER only)
GET    /api/v1/transactions/expenses/top-categories     # Top 3 spending categories (USER only)
GET    /api/v1/transactions/balance                     # Get account balance (USER only)
GET    /api/v1/transactions/summary/monthly             # Monthly income/expense summary (USER only)
GET    /api/v1/transactions/export                      # Export transactions to CSV (USER only)
```

---

## Testing

The application uses the `test` profile with an in-memory **H2** database for testing purposes.  
Tests cover services, controllers, exception handling, and data access logic.

### Run All Tests

```
./mvnw test
```

